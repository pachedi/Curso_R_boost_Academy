---
title: "Introducción a R"
subtitle: "Ejercicios clase 2  Resuelto"
output:
  html_document:
    toc: yes
  html_notebook:
    toc: yes
    toc_float: yes
---
## TAREA CLASE 2

```{r ,echo = FALSE, warning= FALSE}
library(tidyverse)
library(RCurl)
library(openxlsx)
library(lubridate)
```

1-Cargar la base de vacunación en CABA
link : https://raw.githubusercontent.com/pachedi/INTRO_R_CS/main/vacunas_caba.csv
```{r echo = FALSE, warning= FALSE}
vacunas_caba <- read.csv('https://raw.githubusercontent.com/pachedi/INTRO_R_CS/main/vacunas_caba.csv')
head(vacunas_caba)
```
2- Filtrar la base por efector público (también los nacionales)
```{r echo = FALSE, warning= FALSE}
efector_publico <- vacunas_caba %>% 
  filter(TIPO_EFECTOR %in% c('Público','Público nacional'))

unique(efector_publico$TIPO_EFECTOR)

```
  
3- Eliminar la columna ID_CARGA de la tabla original
```{r echo = FALSE, warning= FALSE}
vacunas_caba <- vacunas_caba %>% 
  select(-(9))

colnames(vacunas_caba)
```

4- Cambiar el nombre de la columna "VACUNA" por "MARCA DE LA VACUNA"
```{r echo = FALSE, warning= FALSE}
vacunas_caba <- vacunas_caba %>% 
  mutate(TOTAL_VACUNAS = DOSIS_1+DOSIS_2+DOSIS_3)

head(vacunas_caba)
```

5- Crear un nuevo objeto ordenado de manera descendente y por DOSIS 1
```{r echo = FALSE, warning= FALSE}
vacunas_ordenadas <- vacunas_caba %>% 
  arrange(desc(DOSIS_1))

head(vacunas_ordenadas)
```

6-Obtener una variable resumen que indique la cantidad total de vacunas aplicadas agrupado por día
```{r echo = FALSE, warning= FALSE}
por_dia <- vacunas_caba %>% 
  group_by(FECHA_ADMINISTRACION) %>% 
  summarise(vacunas_por_dia = sum(TOTAL_VACUNAS)) %>% 
  arrange(FECHA_ADMINISTRACION)

head(por_dia)
```

7- Lo mismo que el punto anterior pero también agrupar por Genero
```{r echo = FALSE, warning= FALSE}
por_dia_g <- vacunas_caba %>% 
  group_by(FECHA_ADMINISTRACION, GENERO) %>% 
  summarise(vacunas_por_dia = sum(TOTAL_VACUNAS)) %>% 
  arrange(FECHA_ADMINISTRACION)

head(por_dia_g)
```
8- Crear una nueva tabla que exprese el total de primeras dosis aplicadas agrupado por rango etario
```{r echo = FALSE, warning= FALSE}
grupo_etario <- vacunas_caba %>% 
  group_by(GRUPO_ETARIO) %>% 
  summarise(total_1_dosis = sum(DOSIS_1))
head(grupo_etario)
```
9- Crear una tabla que exprese el total de 2das dosis aplicadas por año y mes
```{r echo = FALSE, warning= FALSE}

vacunas_caba$mes <-  months(as.Date(vacunas_caba$FECHA_ADMINISTRACION)) 
vacunas_caba$anio <-  year(as.Date(vacunas_caba$FECHA_ADMINISTRACION)) 
vacunas_mes <- vacunas_caba %>% 
  group_by(anio,mes) %>% 
  summarise(total = sum(DOSIS_2)) %>% 
  mutate( mes = factor(mes, levels = month.name) ) %>% 
  arrange(anio,mes)

vacunas_mes
  
```
10- Crear una tabla que exprese el total de vacunas aplicadas agrupada por marca de vacuna
```{r echo = FALSE, warning= FALSE}

marca <- vacunas_caba %>% 
  group_by(VACUNA) %>% 
  summarise(Total = sum(TOTAL_VACUNAS, na.rm = TRUE)) %>% 
  arrange(desc(Total))

marca
```
